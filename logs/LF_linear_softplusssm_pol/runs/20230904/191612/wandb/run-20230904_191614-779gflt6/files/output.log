[[36m2023-09-04 19:16:18,640[39m][[34m__main__[39m][[32mINFO[39m] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[[36m2023-09-04 19:16:18,723[39m][[34m__main__[39m][[32mINFO[39m] - Logging hyperparameters!
Running validation before training
Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LF_generate done
In lf datagen, input shape (153600, 100, 1)
In lf datagen, output shape (153600, 100, 1)
In lf_datamodule.py, self.rho_name pol
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
/home/shida/anaconda3/envs/lh/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:430: PossibleUserWarning: The dataloader, val_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 32 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃[1m      Validate metric      [22m┃[1m       DataLoader 0        [22m┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│[36m         val/loss          [39m│[35m    14.867170333862305     [39m│
└───────────────────────────┴───────────────────────────┘
[37mValidation[39m [35m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m25/25[39m [37m0:00:02 • 0:00:00[39m [37m50.42it/s
[?25h[[36m2023-09-04 19:16:24,398[39m][[34m__main__[39m][[32mINFO[39m] - Starting training!
LF_generate done
In lf datagen, input shape (153600, 100, 1)
In lf datagen, output shape (153600, 100, 1)
┏━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃[1m    [22m┃[1m Name               [22m┃[1m Type                  [22m┃[1m Params [22m┃
┡━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│ 0  │ net                │ SoftplusSSM           │  5.3 K │
│ 1  │ net.activation     │ Identity              │      0 │
│ 2  │ net.W              │ CustomLinearLayer     │     32 │
│ 3  │ net.P              │ CustomOrthogonalLayer │  1.0 K │
│ 4  │ net.g              │ MLP                   │  2.1 K │
│ 5  │ net.g.activation   │ Identity              │      0 │
│ 6  │ net.g.linear1      │ Linear                │  1.1 K │
│ 7  │ net.g.linear2      │ Linear                │  1.1 K │
│ 8  │ net.f              │ MLP                   │  2.1 K │
│ 9  │ net.f.activation   │ Identity              │      0 │
│ 10 │ net.f.linear1      │ Linear                │  1.1 K │
│ 11 │ net.f.linear2      │ Linear                │  1.1 K │
│ 12 │ encoder            │ Linear                │     64 │
│ 13 │ encoder.U          │ Linear                │     64 │
│ 14 │ encoder.activation │ Identity              │      0 │
│ 15 │ decoder            │ Linear                │     33 │
│ 16 │ decoder.U          │ Linear                │     33 │
│ 17 │ decoder.activation │ Identity              │      0 │
│ 18 │ train_loss         │ MeanMetric            │      0 │
│ 19 │ val_loss           │ MeanMetric            │      0 │
│ 20 │ test_loss          │ MeanMetric            │      0 │
└────┴────────────────────┴───────────────────────┴────────┘
[1mTrainable params[22m: 5.4 K
[1mNon-trainable params[22m: 0
[1mTotal params[22m: 5.4 K
[1mTotal estimated model params size (MB)[22m: 0
/home/shida/anaconda3/envs/lh/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:430: PossibleUserWarning:
The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers`
argument` (try 32 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
[37mEpoch 0/999[39m [35m╸[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m4/250[39m [37m0:00:00 • 0:00:21[39m [37m11.73it/s[39m [37mv_num: flt6 train/loss: 27.262 










[37mEpoch 0/999[39m [35m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m250/250[39m [37m0:00:22 • 0:00:00[39m [37m11.40it/s[39m [37mv_num: flt6 train/loss: 0.141 
[37mValidation[39m  [35m━━━━━━━━━━━━━━━━━━━━━━━━[90m╺━━━━━━━━━━━━━━━[39m [37m15/25  [39m [37m0:00:00 • 0:00:01[39m [37m35.50it/s







Epoch 1/999 [35m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m250/250[39m [37m0:00:15 • 0:00:00[39m [37m16.00it/s[39m [37mv_num: flt6 train/loss: 0.281 val/loss: 0.043 







Epoch 2/999 [35m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸[90m━━[39m [37m235/250[39m [37m0:00:13 • 0:00:01[39m [37m17.65it/s[39m [37mv_num: flt6 train/loss: 0.003 val/loss: 0.156 








Epoch 3/999 [35m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m250/250[39m [37m0:00:14 • 0:00:00[39m [37m17.54it/s[39m [37mv_num: flt6 train/loss: 0.012 val/loss: 0.03 




















Epoch 6/999 [90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m2/250[39m [37m0:00:00 • 0:00:27[39m [37m9.47it/s[39m [37mv_num: flt6 train/loss: 0.007 val/loss: 0.008 













Epoch 6/999 [35m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m250/250[39m [37m0:00:27 • 0:00:00[39m [37m9.07it/s [39m [37mv_num: flt6 train/loss: 0.004 val/loss: 0.008 
[37mValidation[39m  [35m━━━━━━━━━━━━━━━━━━━━━━━━━━━[90m╺━━━━━━━━━━━━[39m [37m17/25  [39m [37m0:00:00 • 0:00:01[39m [37m35.31it/s













Epoch 7/999 [35m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸[90m━[39m [37m241/250[39m [37m0:00:25 • 0:00:01[39m [37m9.43it/s[39m [37mv_num: flt6 train/loss: 0.005 val/loss: 0.008 













Epoch 8/999 [35m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m250/250[39m [37m0:00:47 • 0:00:00[39m [37m2.34it/s [39m [37mv_num: flt6 train/loss: 0.004 val/loss: 0.005 













Epoch 9/999 [35m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m250/250[39m [37m0:00:29 • 0:00:00[39m [37m8.50it/s [39m [37mv_num: flt6 train/loss: 0.004 val/loss: 0.009 










































Epoch 13/999 [90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m3/250[39m [37m0:00:00 • 0:00:26[39m [37m9.73it/s[39m [37mv_num: flt6 train/loss: 0.012 val/loss: 0.005 





















Epoch 14/999 [35m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m250/250[39m [37m0:00:20 • 0:00:00[39m [37m11.96it/s[39m [37mv_num: flt6 train/loss: 0.003 val/loss: 0.008 










Epoch 15/999 [35m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m250/250[39m [37m0:00:21 • 0:00:00[39m [37m11.93it/s[39m [37mv_num: flt6 train/loss: 0.02 val/loss: 0.005 










Epoch 16/999 [35m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m250/250[39m [37m0:00:21 • 0:00:00[39m [37m11.86it/s[39m [37mv_num: flt6 train/loss: 0.004 val/loss: 0.016 
[37mValidation[39m   [35m━━━━━━━━━━━━━━━━━━━━━━━━[90m╺━━━━━━━━━━━━━━━[39m [37m15/25  [39m [37m0:00:00 • 0:00:01[39m [37m42.15it/s

[?25h[[36m2023-09-04 19:23:21,826[39m][[34m__main__[39m][[32mINFO[39m] - Starting testing!
Restoring states from the checkpoint path at /home/shida/Figure_1/logs/LF_linear_softplusssm_pol/runs/20230904/191612/checkpoints/epoch_016.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
Loaded model weights from the checkpoint at /home/shida/Figure_1/logs/LF_linear_softplusssm_pol/runs/20230904/191612/checkpoints/epoch_016.ckpt
LF_generate done
In lf datagen, input shape (153600, 100, 1)
In lf datagen, output shape (153600, 100, 1)
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃[1m      Validate metric      [22m┃[1m       DataLoader 0        [22m┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│[36m         val/loss          [39m│[35m   0.003341489238664508    [39m│
└───────────────────────────┴───────────────────────────┘
[37mValidation[39m [35m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m25/25[39m [37m0:00:00 • 0:00:00[39m [37m59.63it/s
[?25h
Restoring states from the checkpoint path at /home/shida/Figure_1/logs/LF_linear_softplusssm_pol/runs/20230904/191612/checkpoints/epoch_016.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
Loaded model weights from the checkpoint at /home/shida/Figure_1/logs/LF_linear_softplusssm_pol/runs/20230904/191612/checkpoints/epoch_016.ckpt
/home/shida/anaconda3/envs/lh/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:430: PossibleUserWarning: The dataloader, test_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 32 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
[?25hLF_generate done
In lf datagen, input shape (153600, 100, 1)
In lf datagen, output shape (153600, 100, 1)
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃[1m        Test metric        [22m┃[1m       DataLoader 0        [22m┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│[36m         test/loss         [39m│[35m   0.0032572662457823753   [39m│
└───────────────────────────┴───────────────────────────┘
[37mTesting[39m [35m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m25/25[39m [37m0:00:00 • 0:00:00[39m [37m63.29it/s
[?25h[[36m2023-09-04 19:23:52,367[39m][[34m__main__[39m][[32mINFO[39m] - Best ckpt path: /home/shida/Figure_1/logs/LF_linear_softplusssm_pol/runs/20230904/191612/checkpoints/epoch_016.ckpt
[[36m2023-09-04 19:23:52,370[39m][[34msrc.utils.utils[39m][[32mINFO[39m] - Output dir: /home/shida/Figure_1/logs/LF_linear_softplusssm_pol/runs/20230904/191612
[[36m2023-09-04 19:23:52,370[39m][[34msrc.utils.utils[39m][[32mINFO[39m] - Closing wandb!